<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Painel Vagas Projeto Itaú</title>
  <!-- Tailwind CSS via CDN for quick styling -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <!-- React and ReactDOM UMD builds -->
  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <!-- Babel for in-browser JSX transformation -->
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <!-- Recharts UMD build -->
  <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    // Access React and useState from the global React object
    const { useState } = React;

    // Destructure Recharts components from the global Recharts namespace
    const {
      PieChart,
      Pie,
      Cell,
      Tooltip: RechartsTooltip,
      ResponsiveContainer,
      BarChart,
      Bar,
      XAxis,
      YAxis,
      Legend,
      LineChart,
      Line,
      CartesianGrid,
    } = Recharts;

    // Example data for the demonstration. Replace these with real values later.
    const summary2024 = {
      openRows: 0,
      openPositions: 0,
      approvedRows: 20,
      approvedPositions: 20,
      cancelledRows: 26,
      cancelledPositions: 26,
      avgHireTime: 30,
      avgOpenTime: 45,
      volumeCancelled: 26 * 27000,
      volumeApproved: 20 * 27000,
    };

    const summary2025 = {
      openRows: 2,
      openPositions: 43,
      approvedRows: 0,
      approvedPositions: 0,
      cancelledRows: 2,
      cancelledPositions: 99,
      avgOpenTime: 11,
      volumeCancelled: 2 * 27000,
      volumeOpen: 2 * 27000,
      interviews: 4,
      cvs: 43,
    };

    const typeDistribution2024 = [
      { name: "Nova", value: 651 },
      { name: "Substituição", value: 482 },
    ];

    const typeDistribution2025 = [
      { name: "Nova", value: 22 },
      { name: "Substituição", value: 120 },
    ];

    const monthlySeries2024 = {
      months: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"],
      open: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      approved: [0, 0, 0, 0, 0, 0, 49, 79, 79, 137, 0, 0],
      cancelled: [79, 10, 19, 19, 45, 137, 79, 171, 137, 0, 0, 0],
    };

    const monthlySeries2025 = {
      months: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"],
      open: [0, 0, 0, 0, 0, 0, 49, 50, 0, 0, 0, 0],
      cancelled: [43, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    };

    const topProfiles2024 = [
      { name: "Java", value: 430 },
      { name: "DevOps SRE", value: 108 },
      { name: "Front End", value: 87 },
      { name: "Tester", value: 79 },
      { name: "Fullstack", value: 66 },
    ];

    const topProfiles2025 = [
      { name: "ServiceNow", value: 72 },
      { name: "FullStack", value: 49 },
      { name: ".Net", value: 21 },
    ];

    // Utility for currency formatting
    const formatCurrency = (value) => {
      return value.toLocaleString("pt-BR", {
        style: "currency",
        currency: "BRL",
        maximumFractionDigits: 0,
      });
    };

    // KPI card component
    const KpiCard = ({ title, value, subtitle }) => (
      <div className="bg-white shadow rounded-lg p-4 m-2 flex-1">
        <div className="text-gray-600 text-sm font-semibold">{title}</div>
        <div className="text-3xl font-bold text-minsait-wine">
          {value}
        </div>
        {subtitle && <div className="text-sm text-gray-500 mt-1">{subtitle}</div>}
      </div>
    );

    // Bar chart for top profiles/skills
    const ProfilesBarChart = ({ data }) => (
      <BarChart width={500} height={250} data={data} margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>
        <CartesianGrid strokeDasharray="3 3" />
        <XAxis dataKey="name" />
        <YAxis allowDecimals={false} />
        <Tooltip />
        <Bar dataKey="value" fill="#703151" />
      </BarChart>
    );

    // Pie chart component
    const SimplePieChart = ({ data, colors }) => (
      <PieChart width={400} height={250}>
        <Pie data={data} cx="50%" cy="50%" labelLine={false} label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(1)}%`} outerRadius={100} fill="#8884d8" dataKey="value">
          {data.map((entry, index) => (
            <Cell key={`cell-${index}`} fill={colors[index % colors.length]} />
          ))}
        </Pie>
        <RechartsTooltip formatter={(val) => formatCurrency(val)} />
      </PieChart>
    );

    // Line chart for monthly evolution
    const MonthlyLineChart = ({ data, colors }) => {
      return (
        <LineChart width={500} height={250} data={data.months.map((month, idx) => ({
          name: month,
          Open: data.open[idx],
          Approved: data.approved ? data.approved[idx] : 0,
          Cancelled: data.cancelled[idx],
        }))} margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>
          <CartesianGrid strokeDasharray="3 3" />
          <XAxis dataKey="name" />
          <YAxis allowDecimals={false} />
          <Tooltip />
          <Legend />
          <Line type="monotone" dataKey="Open" stroke={colors[0]} />
          {data.approved && <Line type="monotone" dataKey="Approved" stroke={colors[1]} />}
          <Line type="monotone" dataKey="Cancelled" stroke={colors[2]} />
        </LineChart>
      );
    };

    // Summary table component (simple version)
    const SummaryTable = ({ year }) => (
      <div className="overflow-auto max-h-60">
        <table className="min-w-full text-left text-sm divide-y divide-gray-200">
          <thead className="bg-gray-100">
            <tr>
              <th className="px-2 py-1">Perfil</th>
              <th className="px-2 py-1">Tipo</th>
              <th className="px-2 py-1">Status</th>
              <th className="px-2 py-1">Cliente</th>
              <th className="px-2 py-1">Área</th>
              <th className="px-2 py-1">Data Abertura</th>
              {year === 2024 && <th className="px-2 py-1">Data Contratação</th>}
              <th className="px-2 py-1">Volume</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-200">
            {/* Example static rows. Replace with dynamic data later. */}
            {year === 2024 ? (
              <>
                <tr>
                  <td className="px-2 py-1">Tester</td>
                  <td className="px-2 py-1">Substituição</td>
                  <td className="px-2 py-1">CANCELADA</td>
                  <td className="px-2 py-1">Solange S.</td>
                  <td className="px-2 py-1">Seg. Info</td>
                  <td className="px-2 py-1">2024-05-01</td>
                  <td className="px-2 py-1">2024-06-10</td>
                  <td className="px-2 py-1">R$ 27.000</td>
                </tr>
                <tr>
                  <td className="px-2 py-1">Java</td>
                  <td className="px-2 py-1">Nova</td>
                  <td className="px-2 py-1">APROVADO</td>
                  <td className="px-2 py-1">Rafael U.</td>
                  <td className="px-2 py-1">iCarros</td>
                  <td className="px-2 py-1">2024-05-10</td>
                  <td className="px-2 py-1">2024-06-10</td>
                  <td className="px-2 py-1">R$ 27.000</td>
                </tr>
              </>
            ) : (
              <>
                <tr>
                  <td className="px-2 py-1">ServiceNow</td>
                  <td className="px-2 py-1">Nova</td>
                  <td className="px-2 py-1">CANCELADA</td>
                  <td className="px-2 py-1">Solange S.</td>
                  <td className="px-2 py-1">Seg. Info</td>
                  <td className="px-2 py-1">2025-01-01</td>
                  <td className="px-2 py-1">R$ 27.000</td>
                </tr>
                <tr>
                  <td className="px-2 py-1">.Net</td>
                  <td className="px-2 py-1">Substituição</td>
                  <td className="px-2 py-1">ABERTA</td>
                  <td className="px-2 py-1">Solange S.</td>
                  <td className="px-2 py-1">Seg. Info</td>
                  <td className="px-2 py-1">2025-08-05</td>
                  <td className="px-2 py-1">R$ 27.000</td>
                </tr>
              </>
            )}
          </tbody>
        </table>
      </div>
    );

    // Main App component
    const App = () => {
      const [page, setPage] = useState(2024);

      const colors = ["#e76f51", "#703151", "#264653"];

      return (
        <div className="p-4">
          <h1 className="text-2xl font-bold mb-4 text-center">Projeto Itaú — Painel Executivo de Vagas</h1>
          <div className="flex justify-between items-center mb-4">
            <div>
              <button
                className={`mr-2 px-4 py-2 rounded ${page === 2024 ? "bg-minsait-wine text-white" : "bg-gray-200 text-gray-700"}`}
                onClick={() => setPage(2024)}
              >
                2024
              </button>
              <button
                className={`px-4 py-2 rounded ${page === 2025 ? "bg-minsait-wine text-white" : "bg-gray-200 text-gray-700"}`}
                onClick={() => setPage(2025)}
              >
                2025
              </button>
            </div>
            <button
              className="px-4 py-2 bg-orange-500 text-white rounded"
              onClick={() => window.print()}
            >
              Imprimir / Salvar
            </button>
          </div>

          {/* KPI cards */}
          <div className="flex flex-wrap justify-around mb-4">
            {page === 2024 ? (
              <>
                <KpiCard title="Vagas Abertas" value={summary2024.openPositions} />
                <KpiCard title="Vagas Aprovadas" value={summary2024.approvedPositions} />
                <KpiCard title="Vagas Canceladas" value={summary2024.cancelledPositions} />
                <KpiCard title="Tempo médio de contratação" value={`${summary2024.avgHireTime} dias`} />
                <KpiCard title="Tempo médio de vagas em aberto" value={`${summary2024.avgOpenTime} dias`} />
                <KpiCard title="Volume Cancelado" value={formatCurrency(summary2024.volumeCancelled)} />
                <KpiCard title="Volume Aprovado" value={formatCurrency(summary2024.volumeApproved)} />
              </>
            ) : (
              <>
                <KpiCard title="Vagas Abertas" value={summary2025.openPositions} />
                <KpiCard title="Vagas Aprovadas" value={summary2025.approvedPositions} />
                <KpiCard title="Vagas Canceladas" value={summary2025.cancelledPositions} />
                <KpiCard title="Tempo médio de vagas em aberto" value={`${summary2025.avgOpenTime} dias`} />
                <KpiCard title="Volume Cancelado" value={formatCurrency(summary2025.volumeCancelled)} />
                <KpiCard title="Volume em aberto" value={formatCurrency(summary2025.volumeOpen)} />
                <KpiCard title="Entrevistas" value={summary2025.interviews} />
                <KpiCard title="CVs" value={summary2025.cvs} />
              </>
            )}
          </div>

          {/* Charts */}
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            {page === 2024 ? (
              <>
                <div className="bg-white shadow rounded-lg p-4">
                  <h2 className="font-semibold mb-2">Perfis mais demandados (2024)</h2>
                  <ProfilesBarChart data={topProfiles2024} />
                </div>
                <div className="bg-white shadow rounded-lg p-4">
                  <h2 className="font-semibold mb-2">Distribuição de tipos (Substituição vs Nova)</h2>
                  <SimplePieChart data={typeDistribution2024} colors={colors} />
                </div>
                <div className="bg-white shadow rounded-lg p-4">
                  <h2 className="font-semibold mb-2">Evolução mensal (Abertas, Aprovadas, Canceladas)</h2>
                  <MonthlyLineChart data={monthlySeries2024} colors={colors} />
                </div>
              </>
            ) : (
              <>
                <div className="bg-white shadow rounded-lg p-4">
                  <h2 className="font-semibold mb-2">Perfis mais demandados (2025)</h2>
                  <ProfilesBarChart data={topProfiles2025} />
                </div>
                <div className="bg-white shadow rounded-lg p-4">
                  <h2 className="font-semibold mb-2">Distribuição (Nova vs Substituição)</h2>
                  <SimplePieChart data={typeDistribution2025} colors={colors} />
                </div>
                <div className="bg-white shadow rounded-lg p-4">
                  <h2 className="font-semibold mb-2">Evolução mensal (Abertas, Canceladas)</h2>
                  <MonthlyLineChart data={monthlySeries2025} colors={colors} />
                </div>
              </>
            )}
          </div>

          {/* Summary table */}
          <div className="bg-white shadow rounded-lg p-4">
            <h2 className="font-semibold mb-2">Resumo das Vagas</h2>
            <SummaryTable year={page} />
          </div>
        </div>
      );
    };

    // Custom tailwind theme for colors defined by Itaú and Minsait
    // Add these classes to the document
    const style = document.createElement('style');
    style.innerHTML = `
      .bg-minsait-wine { background-color: #703151; }
      .text-minsait-wine { color: #703151; }
    `;
    document.head.appendChild(style);

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
